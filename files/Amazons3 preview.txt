String awsKey = 'AKIAIJMGB5LSX7DZ5Q2A';
String secret = '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';                
String fileName = 'readme.txt';// File Name
String bucket = 'CEPTESTEST';                      
Datetime dt = Datetime.now();
dt=dt.addHours(3);
Integer second = Integer.valueOf(dt.getTime() /1000);    
String encodedKey = EncodingUtil.urlEncode(fileName, 'UTF-8');      
String str = 'GET\n\n\n'+second+'\n'+''+'/'+bucket+'/'+encodedKey;    
Blob mac= Crypto.generateMac('HmacSHA1', Blob.valueOf(str), Blob.valueOf(secret));
String sign = EncodingUtil.urlEncode(EncodingUtil.base64Encode(mac), 'UTF-8');
String service='https://s3.amazonaws.com';

String url = service+'/'+bucket+'/'+encodedKey+'?AWSAccessKeyId='+awsKey+'&Expires='+second+'&Signature='+sign;
System.debug('Amazon-S3==='+url);


        
